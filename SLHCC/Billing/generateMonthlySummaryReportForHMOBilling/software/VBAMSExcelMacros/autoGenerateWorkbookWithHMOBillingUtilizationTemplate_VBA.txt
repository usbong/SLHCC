Sub autoGenerateWorkbookWithHMOBillingUtilizationTemplate()
' Copyright 2019 Usbong Social Systems, Inc.
'
' Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You ' may obtain a copy of the License at
'
' http://www.apache.org/licenses/LICENSE-2.0
'
' Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, ' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing ' permissions and limitations under the License.
'
' @author: Michael Syson
' @date created: 20190324
' @date updated: 20190325
'
' Given:
' 1) Workbook with the HMO Billing data
'
'Output:
' 1) Auto-generated new Workbook with HMO Billing Utilization data from ORTHO & PT TREATMENT DEPT. Workbook
' 2) Auto-updated Workbook with HMO Billing Utilization Template from Sta. Lucia Health Care Centre (SLHCC)
'
Dim myInput As Worksheet
Dim myOutput As Worksheet 'the same as myInput
Dim row As Range
Dim RowCount As Integer
Dim TableHeaderRow As Integer
Dim LastPrintableRow As Integer
Dim MaxPatientNameColumnWidth As Integer
Dim patientNameFontSize As Integer

'added by Mike, 20190325
Dim INPUT_NON_MASTER_LIST_OFFSET As Integer

Dim INPUT_REFERRING_DOCTOR_COLUMN As Integer
Dim INPUT_NOTES_COLUMN As Integer
Dim INPUT_DATE_COLUMN As Integer
Dim INPUT_PATIENT_NAME_COLUMN As Integer
Dim INPUT_CLASS_COLUMN As Integer
Dim INPUT_NET_PF_COLUMN As Integer
Dim INPUT_NEW_OLD_COLUMN As Integer
Dim INPUT_NEW_OLD_PATIENT_COLUMN As Integer
Dim INPUT_CHARGE_SLIP_NUMBER_COLUMN As Integer
Dim INPUT_APPROVAL_CODE_COLUMN As Integer
Dim INPUT_FEE_COLUMN As Integer
Dim INPUT_DIAGNOSIS_COLUMN As Integer

Dim OUTPUT_HMO_BILLING_DEPARTMENT_PT_VALUE As Variant
Dim OUTPUT_HMO_BILLING_DEPARTMENT_ORTHO_VALUE As Variant
Dim OUTPUT_HMO_BILLING_DEPARTMENT_REHAB_VALUE As Variant

Dim OUTPUT_HMO_BILLING_PROCEDURE_PT_VALUE As Variant
Dim OUTPUT_HMO_BILLING_PROCEDURE_ORTHO_VALUE As Variant
Dim OUTPUT_HMO_BILLING_PROCEDURE_REHAB_VALUE As Variant
Dim OUTPUT_HMO_BILLING_PROCEDURE_ORTHO_PROCEDURE_VALUE As Variant
Dim OUTPUT_HMO_BILLING_PROCEDURE_REHAB_PROCEDURE_VALUE As Variant

Dim OUTPUT_HMO_BILLING_PAYEE_VALUE As Variant

Dim OUTPUT_HMO_BILLING_MEDICAL_DOCTOR_NAME_PT_VALUE As Variant
Dim OUTPUT_HMO_BILLING_UTILIZATION_SUMMARY_MEDICAL_DOCTOR_NAME_PT_VALUE As Variant

Dim INPUT_CONSULTATION_PROCEDURE_COLUMN As Integer
Dim INPUT_CONSULTATION_MEDICAL_DOCTOR_COLUMN As Integer
Dim INPUT_CONSULTATION_MEDICAL_CERTIFICATE_COLUMN As Integer

Dim INPUT_CONSULTATION_PROCEDURE_DETAILS_COLUMN As Integer
Dim INPUT_CONSULTATION_APPROVAL_CODE_COLUMN As Integer
Dim INPUT_CONSULTATION_DIAGNOSIS_COLUMN As Integer

Dim INPUT_CONSULTATION_OFFSET As Integer

'added by Mike, 20190325
'set the values of the defined terms, i.e. value-holders
INPUT_NON_MASTER_LIST_OFFSET = 1 '0
INPUT_REFERRING_DOCTOR_COLUMN = 15 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_NOTES_COLUMN = 0 'This column is not included in the INPUT_NON_MASTER_LIST_OFFSET
INPUT_DATE_COLUMN = 1 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_PATIENT_NAME_COLUMN = 3 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_CLASS_COLUMN = 8 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_NET_PF_COLUMN = 10 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_NEW_OLD_COLUMN = 16 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_NEW_OLD_PATIENT_COLUMN = 16 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_CHARGE_SLIP_NUMBER_COLUMN = 11 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_APPROVAL_CODE_COLUMN = 12 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_FEE_COLUMN = 7 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_DIAGNOSIS_COLUMN = 6 - INPUT_NON_MASTER_LIST_OFFSET

OUTPUT_HMO_BILLING_DEPARTMENT_PT_VALUE = "PT"
OUTPUT_HMO_BILLING_DEPARTMENT_ORTHO_VALUE = "ORTHO"
OUTPUT_HMO_BILLING_DEPARTMENT_REHAB_VALUE = "REHAB"

OUTPUT_HMO_BILLING_PROCEDURE_PT_VALUE = "PT TREATMENT"
OUTPUT_HMO_BILLING_PROCEDURE_ORTHO_VALUE = "ORTHO CONSULT"
OUTPUT_HMO_BILLING_PROCEDURE_REHAB_VALUE = "REHAB CONSULT"
OUTPUT_HMO_BILLING_PROCEDURE_ORTHO_PROCEDURE_VALUE = "ORTHO-PROCEDURE"
OUTPUT_HMO_BILLING_PROCEDURE_REHAB_PROCEDURE_VALUE = "REHAB-PROCEDURE"

OUTPUT_HMO_BILLING_PAYEE_VALUE = "STA. LUCIA HEALTH CARE CENTRE, INC."
    
'all PT Treatment transactions based on the HMO Billing Template
OUTPUT_HMO_BILLING_MEDICAL_DOCTOR_NAME_PT_VALUE = "SYSON, PEDRO"
OUTPUT_HMO_BILLING_UTILIZATION_SUMMARY_MEDICAL_DOCTOR_NAME_PT_VALUE = "PEDRO SYSON"

INPUT_CONSULTATION_PROCEDURE_COLUMN = 2 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_CONSULTATION_MEDICAL_DOCTOR_COLUMN = 16 - INPUT_NON_MASTER_LIST_OFFSET

INPUT_CONSULTATION_MEDICAL_CERTIFICATE_COLUMN = 2 - INPUT_NON_MASTER_LIST_OFFSET 'The value is the same as "INPUT_CONSULTATION_PROCEDURE_COLUMN".

'CONSULTATION
INPUT_CONSULTATION_PROCEDURE_DETAILS_COLUMN = 12 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_CONSULTATION_APPROVAL_CODE_COLUMN = 15 - INPUT_NON_MASTER_LIST_OFFSET
INPUT_CONSULTATION_DIAGNOSIS_COLUMN = 7 - INPUT_NON_MASTER_LIST_OFFSET
    
INPUT_CONSULTATION_OFFSET = 1

'added by Mike, 20190324
Dim hmoBillingContainer As Collection
Set hmoBillingContainer = New Collection

Dim hmoBillingColumnValuesContainer As Collection
Set hmoBillingColumnValuesContainer = New Collection

Dim hmoBillingContainerTransactionCount As Integer

hmoBillingContainerTransactionCount = 1
RowCount = 2 'do not include table header row
RowCountOffset = 0 'This is to make the add-on software automatically adjust to rows with new line marks

Set myInput = Sheets(ActiveSheet.Name)

'added by Mike, 20190325
Set NewWorkbook = Workbooks.Add
    With NewWorkbook
        .SaveAs Filename:="HMOBillingUtilization.xls"
    End With

'   ImportTextFilesAsWorksheetsInWorkbookUtilizationHMOMarch2019_20190301~20190308
End Sub