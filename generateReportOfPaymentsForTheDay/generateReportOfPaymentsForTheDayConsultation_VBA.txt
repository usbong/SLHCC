Sub generateReportOfPaymentsForTheDayConsultation()
' Given:
' 1) Report Today Input Worksheet
' --> Copy-paste all the patient data for the day.
' Output:
' 1) Report Today Output Worksheet
' --> This will be where the VBA script will output and generate the report.
' --> The report will only include NON-HMO's.


Dim myInput As Worksheet
Dim myOutput As Worksheet
Dim row As Range
Dim RowCount As Integer
Dim RowCountOutput As Integer

RowCount = 1
RowCountOutput = 2

Set myInput = Sheets("Report_Today_Input")
Set myOutput = Sheets("Report_Today_Output")

'added by Mike, 20181009
'set back the selected cell in the input worksheet to the top-left cell, i.e. A1, as default
'This is to make sure that when the next input the following day is pasted, the default selected cell in the input worksheet is the first row and column.
'Otherwise, it is possible that the human encoder may inadvertently paste the input for the day in the wrong row and column.
'This is a case that my team and I have experienced.
myInput.Range("A1").Select

'added by Mike, 20180705
'clear/delete the contents, background color, and border of all used cells first
myOutput.UsedRange.ClearContents
myOutput.UsedRange.Interior.ColorIndex = 0
myOutput.UsedRange.Borders.LineStyle = xlNone

' add the headers of the table
myOutput.Range("A" & 1) = "DATE:"
' skip column B
myOutput.Range("C" & 1) = "OR#:"
myOutput.Range("D" & 1) = "NAME:"
myOutput.Range("E" & 1) = "FEE:"
myOutput.Range("F" & 1) = "CLASS:"
myOutput.Range("G" & 1) = "AMT. PAID:"
myOutput.Range("H" & 1) = "PF:"

myOutput.Range("A" & 1, "H" & 1).Font.Size = 16
myOutput.Range("A" & 1, "H" & 1).Interior.Color = vbGreen

For Each row In myInput.Rows
       '1) SLR stands for "Sta. Lucia Reality", which is a corporate client of the Sta. Lucia Health Care Center, Inc. (SLHCC).
       'SLR's payment procedure to the Marikina Orthopedic Specialty Clinic (MOSC)'s Rehab/Clinic is similar to a Health Maintenance Organization (HMO)'s as well as PhilHealth's.
       '2) NC stands for "No Charge", which means that the medical doctor did not charge the patient a fee for the consultation
       If InStr(myInput.Range("I" & RowCount).Value, "HMO") = 0 And myInput.Range("I" & RowCount).Value <> "SLR" And myInput.Range("I" & RowCount).Value <> "NC" Then
       'If InStr(myInput.Range("I" & RowCount).Value, "HMO") = 0 And myInput.Range("I" & RowCount).Value <> "SLR" Then
       'If InStr(myInput.Range("I" & RowCount).Value, "HMO") = 0 Then

            'Date:
            myInput.Range("A" & RowCount).Columns.Copy
            myOutput.Select
            myOutput.Range("A" & RowCountOutput).PasteSpecial
            
            'Transaction Row #
            myOutput.Range("B" & RowCountOutput) = RowCountOutput - 1
            
            'OR#
            myInput.Range("O" & RowCount).Columns.Copy
            myOutput.Select
            myOutput.Range("C" & RowCountOutput).PasteSpecial

            'NAME:
            myInput.Range("C" & RowCount).Columns.Copy
            myOutput.Select
            myOutput.Range("D" & RowCountOutput).PasteSpecial
            
            'FEE
            myInput.Range("H" & RowCount, "K" & RowCount).Columns.Copy
            myOutput.Select
            myOutput.Range("E" & RowCountOutput, "H" & RowCountOutput).PasteSpecial
            
            myOutput.Range("A" & RowCountOutput, "H" & RowCountOutput).Font.Size = 16
            
            If RowCountOutput Mod 2 = 0 Then 'even number
             myOutput.Range("A" & RowCountOutput, "H" & RowCountOutput).Interior.Color = vbYellow
            Else
             myOutput.Range("A" & RowCountOutput, "H" & RowCountOutput).Interior.Color = vbGreen
            End If
            
            RowCountOutput = RowCountOutput + 1
       End If
       
       If IsEmpty(myInput.Range("C" & RowCount).Value) Then
            Exit For
       Else
            RowCount = RowCount + 1
       End If
Next row

RowCountOutput = RowCountOutput - 1
myOutput.Range("B" & RowCountOutput) = "" 'remove the number in the last row

'get total of AMT. PAID
RowCountOutputSum = RowCountOutput - 1
myOutput.Range("G" & RowCountOutput).Formula = "=Sum(G2:G" & RowCountOutputSum & ")"

'get total of PF (Professional Fee)
myOutput.Range("H" & RowCountOutput).Formula = "=Sum(H2:H" & RowCountOutputSum & ")"

myOutput.Columns("A:H").AutoFit
'TODO: -add: border to all used cells; the instruction below adds borders even to column I, which is the column to the right of the right-most column, i.e. "PF:" column, which may likely be due to column I's left border also being used
'myOutput.UsedRange.Borders.LineStyle = 1

End Sub